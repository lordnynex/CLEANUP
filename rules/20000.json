{"header_filter":{},"body_filter":{},"access":[{"operator":"REGEX","id":20001,"pattern":"^(?:GET|HEAD)$","description":"GET/HEAD request with a body","action":"CHAIN","opts":{"nolog":true},"vars":[{"type":"METHOD"}]},{"id":20002,"op_negated":1,"vars":[{"parse":{"specific":"content-length"},"type":"REQUEST_HEADERS"}],"action":"SCORE","opts":{"score":2},"pattern":"0","operator":"EQUALS","description":"GET/HEAD request with a body"},{"pattern":"POST","id":20003,"operator":"EQUALS","vars":[{"type":"METHOD"}],"opts":{"nolog":true},"action":"CHAIN","description":"POST request does not have a Content-Length Header"},{"description":"POST request does not have a Content-Length Header","pattern":"content-length","operator":"CONTAINS","vars":[{"type":"REQUEST_HEADERS","parse":{"keys":1}}],"op_negated":1,"action":"SCORE","opts":{"score":2},"id":20004},{"vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"content-encoding"}}],"action":"SCORE","opts":{"score":2,"transform":"lowercase"},"description":"Identity should not be used in Content-Encoding, only in Accept-Encoding","pattern":"identity","id":20005,"operator":"EQUALS"},{"pattern":"100-continue","operator":"REGEX","id":20006,"vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"expect"}}],"description":"Expect header sent in non-HTTP/1.1 request","opts":{"nolog":true},"action":"CHAIN"},{"description":"Expect header sent in non-HTTP/1.1 request","pattern":1.1,"operator":"EQUALS","op_negated":1,"vars":[{"type":"HTTP_VERSION"}],"action":"SCORE","opts":{"score":2},"id":20007},{"opts":{"nolog":true},"action":"CHAIN","vars":[{"parse":{"keys":1},"type":"REQUEST_HEADERS"}],"id":20008,"operator":"CONTAINS","pattern":"pragma"},{"vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"pragma"}}],"opts":{"nolog":true,"transform":"lowercase"},"action":"CHAIN","pattern":"no-cache","operator":"EQUALS","id":20009},{"vars":[{"parse":{"keys":1},"type":"REQUEST_HEADERS"}],"op_negated":1,"opts":{"nolog":true},"action":"CHAIN","pattern":"cache-control","operator":"CONTAINS","id":20010},{"pattern":"1.1","operator":"EQUALS","description":"HTTP/1.1 request sent with a Pragma:no-cache header, but no corresponding Cache-Control header","id":20011,"op_negated":1,"vars":[{"type":"HTTP_VERSION"}],"action":"SCORE","opts":{"score":2}},{"opts":{"score":2},"action":"SCORE","description":"Request sent with abnormal Range header","vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"range"}}],"id":20012,"operator":"REGEX","pattern":"^bytes=0-"},{"opts":{"score":2},"action":"SCORE","description":"Excessive number of byte range fields within one request","vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"range"}}],"id":20013,"operator":"REGEX","pattern":"^bytes=(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,"},{"description":"Excessive number of byte range fields within one request","action":"SCORE","opts":{"score":2},"vars":[{"parse":{"specific":"request-range"},"type":"REQUEST_HEADERS"}],"operator":"REGEX","id":20014,"pattern":"^bytes=(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,"},{"description":"Duplicate/broken connection header","action":"SCORE","opts":{"score":2},"vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"connection"}}],"operator":"REGEX","id":20015,"pattern":"\\b(keep-alive|close),\\s?(keep-alive|close)\\b"}]}
