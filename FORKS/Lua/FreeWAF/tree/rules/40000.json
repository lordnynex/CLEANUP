{"header_filter":{},"body_filter":{},"access":[{"description":"OS Command Injection detected","pattern":"(?:(?:[\\;\\|\\`]\\W*?\\bcc|\\b(wget|curl))\\b|\\/cc(?:[\\'\\\"\\|\\;\\`\\-\\s]|$))","vars":[{"parse":{"all":1},"type":"REQUEST_ARGS"}],"opts":{"score":4},"action":"SCORE","operator":"REGEX","id":40001},{"pattern":"[^\\w\\r\\n]{4,}","description":"Repetative non-word characters anomaly detected","vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}],"opts":{"score":4,"transform":"uri_decode"},"action":"SCORE","operator":"REGEX","id":40002},{"action":"SCORE","opts":{"score":4},"id":40003,"operator":"REGEX","description":"Coldfusion injection detected","pattern":"\\bcf(?:usion_(?:d(?:bconnections_flush|ecrypt)|set(?:tings_refresh|odbcini)|getodbc(?:dsn|ini)|verifymail|encrypt)|_(?:(?:iscoldfusiondatasourc|getdatasourceusernam)e|setdatasource(?:password|username))|newinternal(?:adminsecurit|registr)y|admin_registry_(?:delete|set)|internaldebug|execute)\\b","vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}]},{"vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}],"description":"LDAP Injection detected","pattern":"(?:\\((?:\\W*?(?:objectc(?:ategory|lass)|homedirectory|[gu]idnumber|cn)\\b\\W*?=|[^\\w\\x80-\\xFF]*?[\\!\\&\\|][^\\w\\x80-\\xFF]*?\\()|\\)[^\\w\\x80-\\xFF]*?\\([^\\w\\x80-\\xFF]*?[\\!\\&\\|])","opts":{"score":4},"action":"SCORE","id":40004,"operator":"REGEX"},{"vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}],"description":"SSI injection detected","pattern":"<!--\\W*?#\\W*?(?:e(?:cho|xec)|printenv|include|cmd)","action":"SCORE","opts":{"score":4},"operator":"REGEX","id":40005},{"pattern":"http:\\/\\/[\\w\\.]+?\\/.*?\\.pdf\\b[^\\x0d\\x0a]*#","description":"UPDF XSS","vars":[{"parse":{"all":1},"type":"REQUEST_ARGS"}],"operator":"REGEX","id":40006,"action":"SCORE","opts":{"score":4}},{"action":"SCORE","opts":{"score":4},"operator":"REGEX","id":40007,"pattern":"[\\n\\r]\\s*\\b(?:to|b?cc)\\b\\s*:.*?\\@","description":"E-mail injection","vars":[{"parse":{"all":1},"type":"REQUEST_ARGS"}]},{"operator":"REGEX","id":40008,"opts":{"score":4},"action":"SCORE","description":"HTTP Request Smuggling","vars":[{"parse":{"specific":"content-length"},"type":"REQUEST_HEADERS"}],"pattern":","},{"id":40009,"operator":"REGEX","action":"SCORE","opts":{"score":4},"description":"HTTP Request Smuggling","pattern":",","vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"transfer-encoding"}}]},{"operator":"REGEX","id":40010,"action":"SCORE","opts":{"score":4},"pattern":"[\\n\\r](?:content-(type|length)|set-cookie|location):","vars":[{"parse":{"all":1},"type":"REQUEST_ARGS"}],"description":"HTTP Response Splitting"},{"vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}],"description":"HTTP Response Splitting","pattern":"(?:\\bhttp\\/(?:0\\.9|1\\.[01])|<(?:html|meta)\\b)","id":40011,"operator":"REGEX","action":"SCORE","opts":{"score":4}},{"pattern":"^(?:ht|f)tps?:\\/\\/(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})","vars":[{"parse":{"all":1},"type":"REQUEST_ARGS"}],"description":"Remote File Inclusion - URL in request argument","id":40012,"operator":"REGEX","opts":{"score":4},"action":"SCORE"},{"pattern":"(?:(\\binclude\\s*\\([^)]*|mosConfig_absolute_path|_CONF\\[path\\]|_SERVER\\[DOCUMENT_ROOT\\]|GALLERY_BASEDIR|path\\[docroot\\]|appserv_root|config\\[root_dir\\])=(ht|f)tps?:\\/\\/)","vars":[{"parse":{"all":1},"type":"REQUEST_ARGS"}],"description":"Remote File Inclusion - PHP include() function","action":"SCORE","opts":{"transform":"uri_decode","score":4},"id":40013,"operator":"REGEX"},{"operator":"REGEX","id":40014,"action":"SCORE","opts":{"score":4},"description":"Remote File Inclusion - RFI data ends with question mark","pattern":"^(?:ft|htt)ps?(.*?)\\?+$","vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}]},{"opts":{"score":4,"transform":"uri_decode"},"action":"SCORE","id":40015,"operator":"REGEX","vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}],"pattern":"(?:\\.cookie\\b.*?;\\W*?(?:expires|domain)\\W*?=|\\bhttp-equiv\\W+set-cookie\\b)","description":"Session fixation attack detected"},{"description":"System file access attempt","pattern":"(?:\\b(?:\\.(?:ht(?:access|passwd|group)|www_?acl)|global\\.asa|httpd\\.conf|boot\\.ini)\\b|\\/etc\\/)","vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}],"opts":{"score":4},"action":"SCORE","operator":"REGEX","id":40016},{"action":"SCORE","opts":{"score":4},"id":40017,"operator":"REGEX","pattern":"\\b(?:(?:n(?:map|et|c)|w(?:guest|sh)|telnet|rcmd|ftp)\\.exe\\b|cmd(?:(?:32)?\\.exe\\b|\\b\\W*?\\/c))","vars":[{"parse":{"all":1},"type":"REQUEST_ARGS"}],"description":"System command access attempt"},{"description":"System command injection attempt","vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}],"pattern":"(?:\\b(?:(?:n(?:et(?:\\b\\W+?\\blocalgroup|\\.exe)|(?:map|c)\\.exe)|t(?:racer(?:oute|t)|elnet\\.exe|clsh8?|ftp)|(?:w(?:guest|sh)|rcmd|ftp)\\.exe|echo\\b\\W*?\\by+)\\b|c(?:md(?:(?:\\.exe|32)\\b|\\b\\W*?\\/c)|d(?:\\b\\W*?[\\\\/]|\\W*?\\.\\.)|hmod.{0,40}?\\+.{0,3}x))|[\\;\\|\\`]\\W*?\\b(?:(?:c(?:h(?:grp|mod|own|sh)|md|pp)|p(?:asswd|ython|erl|ing|s)|n(?:asm|map|c)|f(?:inger|tp)|(?:kil|mai)l|(?:xte)?rm|ls(?:of)?|telnet|uname|echo|id)\\b|g(?:\\+\\+|cc\\b)))","opts":{"score":4},"action":"SCORE","id":40018,"operator":"REGEX"},{"description":"PHP Injection","pattern":"<\\?(?!xml)","vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}],"opts":{"score":4},"action":"SCORE","operator":"REGEX","id":40019},{"id":40020,"operator":"REGEX","action":"SCORE","opts":{"score":4},"pattern":"(?:\\b(?:f(?:tp_(?:nb_)?f?(?:ge|pu)t|get(?:s?s|c)|scanf|write|open|read)|gz(?:(?:encod|writ)e|compress|open|read)|s(?:ession_start|candir)|read(?:(?:gz)?file|dir)|move_uploaded_file|(?:proc_|bz)open|call_user_func)|\\$_(?:(?:pos|ge)t|session))\\b","description":"PHP Injection","vars":[{"parse":{"all":1},"type":"REQUEST_ARGS"}]},{"id":40021,"operator":"REGEX","opts":{"transform":"uri_decode","score":4},"action":"SCORE","pattern":"(?:(?:(?:(?:a(?:llow_url_includ|uto_prepend_fil)e|s(?:uhosin.simulation|afe_mode)|disable_functions|open_basedir)=|php://input)))","vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}],"description":"PHP Injection"},{"opts":{"score":4},"action":"SCORE","operator":"REGEX","id":40022,"pattern":"(?:\\x5c|(?:%(?:2(?:5(?:2f|5c)|%46|f)|c(?:0%(?:9v|af)|1%1c)|u(?:221[56]|002f)|%32(?:%46|F)|e0%80%af|1u|5c)|\\/))(?:%(?:2(?:(?:52)?e|%45)|(?:e0%8|c)0%ae|u(?:002e|2024)|%32(?:%45|E))|\\.){2}(?:\\x5c|(?:%(?:2(?:5(?:2f|5c)|%46|f)|c(?:0%(?:9v|af)|1%1c)|u(?:221[56]|002f)|%32(?:%46|F)|e0%80%af|1u|5c)|\\/))","description":"Directory traversal (volatile match)","vars":[{"type":"REQUEST_ARGS","parse":{"all":1}}]},{"pattern":"%00+$","description":"Null byte at end of URI","vars":[{"type":"URI"}],"action":"SCORE","opts":{"score":4},"operator":"REGEX","id":40023}]}
