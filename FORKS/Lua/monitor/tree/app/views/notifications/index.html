<div class="row-fluid">

  <aside list-filter filter-title="Notifications menu" class="span3" ng-controller="NotificationsNavigationCtrl">
    <a rel="external" class="help-link" docs-ref="notifications"><i class="icon-help"></i></a>
    <p>
      You can think of 'Notifications' as the log of what is happening in the system.
      When something happens, e.g. a pipeline is changed, a middleware crashes,
      an email is sent or you set up your own logging, this information will be stored and displayed here.
    </p>


    <p>
      The "10 seconds passed" notifications are for analytics processing.
      If they are deleted, they will not be counted in the analytics.
    </p>
  </aside>

  <section class="span9">

    <div demo-block="notifications">
      <h4>Keep track of what's happening</h4>
      <p>Events generated by the system, or events triggered by middlewares are shown here.
        Events can be filtered, and these filters can be saved for future reference.
        Learn more about <a href="/">searching and filtering</a>.</p>


    </div>

    <div search-box></div>
    <div control-box></div>

    <load-more>Load {{ search.has_more }} more notifications</load-more>

    <ul slug-list class="notifications"
        infinite-scroll="search.load_more = true" infinite-scroll-immediate-check="false"
        infinite-scroll-disabled="!search.infinite()">
      <li search-loading="search.loading"></li>

      <li slug-item="event" ng-repeat="event in search.results track by event._id"
          slug-item-expanded="event._id == selected_event"
          class="notification" ng-class="{highlighted: event.starred}" >
        <heading>
          <span toggle-item="event"/>

          <toggle class="main">
            <h4 class="slug-item-title"><a href truncate="40">{{  event.msg }}</a></h4>
            <details>
              <detail class="log-level"><span log-level="event.level"/></detail>
              <detail class="channel channel-{{ event.channel | lowercase }}"><b>{{ event.channel }}</b></detail>
              <detail class="timestamp" am-time-ago="event._created_at | unix"></detail>
            </details>
          </toggle>

          <actions>
            <action-item><a href action ng-click="highlightItems([event])" icon="icon-star" text="Highlight" /></action-item>
            <action-item><a href action ng-click="filterItems([event])" icon="icon-filter" text="Filter" /></action-item>
            <action-item><a href action slug-confirm  ng-click="trashItems([event])" icon="icon-trash" text="Delete" /></action-item>
          </actions>

        </heading>

        <content>
          <div class="wrap">
            <pretty-print value="event" lang="json"></pretty-print>
          </div>
        </content>
      </li>
      <li ng-show="search.noResults()" class="no-results"><strong>No results found for</strong> {{ search.json }} </li>
      <li search-load-more>Load more events ({{ search.results.length }}/{{ search.count }})</li>
      <li search-loading="search.loading_more"></li>
    </ul>

  </section>

</div>
